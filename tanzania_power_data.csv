import pandas as pd
from io import StringIO

# =====================
# DATA YAKO MOJA KWA MOJA
# =====================
data = """Date;Time;Global_active_power;Global_reactive_power;Voltage;Global_intensity;Sub_metering_1;Sub_metering_2;Sub_metering_3
16/12/2006;17:24:00;4.216;0.418;234.840;18.400;0.000;1.000;17.000
16/12/2006;17:25:00;5.360;0.436;233.630;23.000;0.000;1.000;16.000
16/12/2006;17:26:00;5.374;0.498;233.290;23.000;0.000;2.000;17.000
16/12/2006;17:27:00;5.388;0.502;233.740;23.000;0.000;1.000;17.000
16/12/2006;17:28:00;3.666;0.528;235.680;15.800;0.000;1.000;17.000
16/12/2006;17:29:00;3.520;0.522;235.020;15.000;0.000;2.000;17.000
16/12/2006;17:30:00;3.702;0.520;235.090;15.800;0.000;1.000;17.000
16/12/2006;17:31:00;3.700;0.520;235.220;15.800;0.000;1.000;17.000
16/12/2006;17:32:00;3.668;0.510;233.990;15.800;0.000;1.000;17.000
16/12/2006;17:33:00;3.662;0.510;233.860;15.800;0.000;2.000;16.000
16/12/2006;17:34:00;4.448;0.498;232.860;19.600;0.000;1.000;17.000
16/12/2006;17:35:00;5.412;0.470;232.780;23.200;0.000;1.000;17.000
16/12/2006;17:36:00;5.224;0.478;232.990;22.400;0.000;1.000;16.000
16/12/2006;17:37:00;5.268;0.398;232.910;22.600;0.000;2.000;17.000
16/12/2006;17:38:00;4.054;0.422;235.240;17.600;0.000;1.000;17.000
16/12/2006;17:39:00;3.384;0.282;237.140;14.200;0.000;0.000;17.000
16/12/2006;17:40:00;3.270;0.152;236.730;13.800;0.000;0.000;17.000
16/12/2006;17:41:00;3.430;0.156;237.060;14.400;0.000;0.000;17.000
16/12/2006;17:42:00;3.266;0.000;237.130;13.800;0.000;0.000;18.000
16/12/2006;17:43:00;3.728;0.000;235.840;16.400;0.000;0.000;17.000
16/12/2006;17:44:00;5.894;0.000;232.690;25.400;0.000;0.000;16.000
16/12/2006;17:45:00;7.706;0.000;230.980;33.200;0.000;0.000;17.000
16/12/2006;17:46:00;7.026;0.000;232.210;30.600;0.000;0.000;16.000
16/12/2006;17:47:00;5.174;0.000;234.190;22.000;0.000;0.000;17.000
16/12/2006;17:48:00;4.474;0.000;234.960;19.400;0.000;0.000;17.000
16/12/2006;17:49:00;3.248;0.000;236.660;13.600;0.000;0.000;17.000
16/12/2006;17:50:00;3.236;0.000;235.840;13.600;0.000;0.000;17.000
16/12/2006;17:51:00;3.228;0.000;235.600;13.600;0.000;0.000;17.000
16/12/2006;17:52:00;3.258;0.000;235.490;13.800;0.000;0.000;17.000
16/12/2006;17:53:00;3.178;0.000;235.280;13.400;0.000;0.000;17.000
16/12/2006;17:54:00;2.720;0.000;235.060;11.600;0.000;0.000;17.000
16/12/2006;17:55:00;3.758;0.076;234.170;16.400;0.000;0.000;17.000
16/12/2006;17:56:00;4.342;0.090;233.770;18.400;0.000;0.000;16.000
16/12/2006;17:57:00;4.512;0.000;233.620;19.200;0.000;0.000;17.000
16/12/2006;17:58:00;4.058;0.200;234.680;17.600;0.000;0.000;17.000
16/12/2006;17:59:00;2.472;0.058;236.940;10.400;0.000;0.000;17.000
16/12/2006;18:00:00;2.790;0.180;237.520;11.800;0.000;0.000;18.000
16/12/2006;18:01:00;2.624;0.144;238.200;11.000;0.000;0.000;17.000
16/12/2006;18:02:00;2.772;0.118;238.280;11.600;0.000;0.000;17.000
16/12/2006;18:03:00;3.740;0.108;236.930;16.400;0.000;16.000;18.000
16/12/2006;18:04:00;4.928;0.202;235.010;21.000;0.000;37.000;16.000
16/12/2006;18:05:00;6.052;0.192;232.930;26.200;0.000;37.000;17.000
16/12/2006;18:06:00;6.752;0.186;232.120;29.000;0.000;36.000;17.000
16/12/2006;18:07:00;6.474;0.144;231.850;27.800;0.000;37.000;16.000
16/12/2006;18:08:00;6.308;0.116;232.250;27.000;0.000;36.000;17.000
16/12/2006;18:09:00;4.464;0.136;234.660;19.000;0.000;37.000;16.000
16/12/2006;18:10:00;3.396;0.148;236.200;15.000;0.000;22.000;18.000
"""  # NOTE: Unaweza kuongeza data yako yote hapa  

# =====================
# READ DATA
# =====================
df = pd.read_csv(StringIO(data), sep=';', parse_dates=[['Date','Time']], dayfirst=True)

# Convert columns to numeric
cols = ['Global_active_power','Global_reactive_power','Voltage',
        'Global_intensity','Sub_metering_1','Sub_metering_2','Sub_metering_3']
df[cols] = df[cols].apply(pd.to_numeric, errors='coerce')

# =====================
# PRINT SAMPLE
# =====================
print(df.head())
print("\nData type check:\n", df.dtypes)
